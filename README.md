# EDRobot
### Elite Dangerous trading robot

TODO enlish text

### Elite Dangerous робот для торговли.

Умеет продавать товары на станции по несколько штук.

После запуска показывает диалог приветствия - просто нажмите Enter или Esc.

Для начала торговли, зайдите на рынок станции в раздел Продажи,
станьте на нужный товар (или откройте диалог продажи этого товара)
и нажмите кнопку **PrintScreen**. Появится диалог - сколько раз продавать,
и по скольку штук товара за один раз продавать.

Заполните поля, и нажмите Enter на клавиатуре или кнопку OK в диалоге.

Для отмены торговли нажмите Esc или кнопку Cancel в диалоге.

Для завершения работы программы нажмите кнопку Exit в диалоге.

Робот начнёт продажи товара. Для остановки продаж - нажмите Esc.
Не переключайтесь в другие окна, не нажимайте кнопки на клавиатуре
и не двигайте мышкой.

### Калибровка цвета

EDRobot распознаёт кнопки в фокусе ввода (чтоб быть уверенным, что активирует
правильную кнопку). Он различает их по яркости, но яркость интерфейса может
сильно отличаться в зависимости от настроек игры. Поэтому при смене настроек
программы (особенно гамма-коррекции и яркости интерфейса!!!) следует пройти
процедуру калибровки цветов. Надеюсь, в будущем это будет делаться более
автоматчески, чем сейчас.

Для калибровки цветов:
- войдите на любой станции в раздел **торговли**, во вкладку **продажи товаров**
- вызовите EDRobot (кнопкой PrintScreen, если вы её не перенастроили), и
  в меню **File** нужно выбрать пункт **Calibrate**
- после этого дождаться окончания процедуры, мышку не трогать, кнопки не нажимать
- во время калибровки откроется диалог продажи, закроется, переключиться на
  режим покупки, откроет диалог покупки, закроет, переключится в режим
  покупки и поставит курсор на кнопку выхода.
- в косоль программа напишет, была ли калибровка успешной или нет; если
  нет - попробуйте повторить ещё раз.

### Troubleshooting

TODO enlish text

### Проблемы и их способы решения

##### Работа не начинается

Робот анализирует UI (изображение) при помощи OpenCV и таким образом
понимает в каком диалоге он находится. Если распознание текущей
ситуации не получается - торговля не начинается (или прекращается).

Для понимания какие регионы экрана робот "видит" и "распознаёт" можно
нажать **Ctrl+Alt+PrintScreen**, в появившемся изображении будут распознанные
области обозначены белыми прямоугольниками, нераспознанные серыми тонкими
перечёркнутыми накрест прямоугольниками, а распознанные, но не уверенно будут
отображаться промежуточной яркостью и зачёркнутые одной линией.

Изображения для сравнения находятся в папке templates. Описание экранов
и регионов для сравнения в файле screens.json5

Если в видите, что изображение ищется в недостаточно большой области -
увеличьте параметр "search-region-extent" в настройках (файл configuration.json5).

##### Кнопки нажимаются слишком быстро или медленно

Всё время задаётся в миллисекундах. Типичное нажатие клавиши - 25 миллисекунд
удержание нажатой, 50 миллисекунд перерыв между нажатиями. 

В configuration.json5 можно изменить эти значения на другие, для
кнопок время нажатия которых задано по умолчанию.

"default-key-hold-time" - время удержания (в нажатом положении)

"default-key-after-time" - промежуток между нажатиями (пауза после отпускания кнопки)

Для некоторых случаев время задаётся напрямую в конфигурации действий торговли
в файле actions.json5

